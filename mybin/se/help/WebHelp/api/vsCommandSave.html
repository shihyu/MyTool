<html>
<head>
<link rel="stylesheet" href="slickedit_api.css" type="text/css">
<title>vsCommandSave</title>
</head>
<body>

<h3><b>int VSAPI vsCommandSave(int wid, const char *pszOutputFilename=a, const char *pszOptions=a)</b></h3>
<P style="margin-top:0pt;margin-bottom:0pt;" class="JavadocDescription"><p>This function saves the buffer date from the editor control specified to
the output file specified.  This function is identical to making the call
vsExecute(wid,"save "\"pszOutputFilename\"") except that
<b>vsRefresh</b> is not called, a new undo step is never started, and
code is not generated by macro recording.</p><p>
<p>The <B>VSP_MODIFY</B> property is turned off if the output
filename is the same as the buffer name.</p>
<P style="margin-bottom:0pt;" class="JavadocHeading"><B>Parameters:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="wid">wid</A></code> - Window id of editor control.  0 specifies the
current object.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="pszOutputFilename">pszOutputFilename</A></code> - Specifies name of output file.  If this
is 0, the buffer name (VSP_BUFNAME) is
used.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="pszOptions">pszOptions</A></code> - A string of zero or more of the following
switches delimited with a space:

<p>Note that since record files are saved in binary (always with the +B
switch), many options have no effect.</p>

<dl>
<dt>+ or -E</dt><dd>Turn on/off expand tabs to spaces switch.  Default
is off.</dd>

<dt>+ or -G</dt><dd>Turn on/off setting of all old numbers.  Default is
off.  SlickEdit uses old line numbers to
better handle going to an error line after lines have
been inserted or deleted.  We don't recommend
setting the old line numbers on every save because
this requires that you do not save the file until you
have performed edits for all compile or multi-file
search messages.  See
<b>_SetAllOldLineNumbers</b> method for more
information.</dd>

<dt>+ or -S</dt><dd>Strip trailing spaces on each line.  The buffer is
modified if the output file name matches the buffer
name.  Default is off.</dd>

<dt>+ or -CL</dt><dd>Check maximum line length.  Default is off.  If the
destination file is requires a record length (an
OS/390 dataset member), lines are checked against
this record length.  Otherwise, line lengths are
checked against the <b>p_MaxLineLength</b>
property.  If there are any lines that are too long, an
error code is returned and a message box is
displayed with a list of the offending line numbers.
At the moment only the physical line length is
checked as if tab characters count as 1 character.
We may change this in the future.</dd>

<dt>+FU</dt><dd>Save file in UNIX ASCII format (Lines ending with
just 10 character).  The buffer is modified if the
output file name matches the buffer name.</dd>

<dt>+FD</dt><dd>Save file in DOS  ASCII format (Lines ending with
13,10).  The buffer is modified if the output file
name matches the buffer name.</dd>

<dt>+FM</dt><dd>Save file in Macintosh ASCII format (Lines ending
with just 13 character).  The buffer is modified if
the output file name matches the buffer name.</dd>

<dt>+<i>ddd</i></dt><dd>Save file without line end characters and pad or
truncate lines so that each line is <i>ddd</i>
characters in length.  Use this option to generate of
fixed length record file.</dd>

<dt>+FR</dt><dd>Save file without line end characters.</dd>

<dt>+F<i>ddd</i></dt><dd>Save file using ASCII character <i>ddd</i> as the
line end character.  The buffer is modified if the
output file name matches the buffer name.</dd>

<dt>+ or -B</dt><dd>Binary switch.  Save file exactly byte per byte as it
appears in the buffer.  This option overrides all save
options which effect bytes in the input or output.
This option is always on for record buffers.
Defaults to value of <b>p_binary</b> property for
other buffers.</dd>

<dt>+ or -O</dt><dd>Overwrite destination switch (no backup).  Default
is off.  Useful for writing a file to a device such as
the printer.</dd>

<dt>+ or -T</dt><dd>Compress saved file with tab increments of 8.
Default is off.</dd>

<dt>+ or -ZR</dt><dd>Remove end of file marker (Ctrl+Z).  This option is
ignored if the current buffer is not a DOS ASCII
file.  The buffer is modified if the
<b>p_showeof</b> is true and the output file name
matches the buffer name.  Default is off.</dd>

<dt>+ or -Z</dt><dd>Add end of file marker (Ctrl+Z).  Note that if a
buffer has a visible EOF character, the output file
will still have an EOF character.  Use +ZR to
ensure that the output file does not have and EOF
character.  Default is off.</dd>

<dt>+ or -L</dt><dd>Reset line modify flags.  Default is off.</dd>

<dt>+ or -N</dt><dd>Don't save lines with the VSLF_NOSAVE bit set.
When the editor keeps track of whether a buffer has
lines with the VSLF_NOSAVE bit set, we will not
need this option.</dd>

<dt>+ or -A</dt><dd>Convert destination filename to absolute.  Default
is on.  This option is currently used to write files to
device names such as PRN.  For example,
"_save_file +o -a +e prn" sends the current buffer
to the printer.</dd>

<dt>+DB, -DB, +D,-D,+DK,-DK</dt><dd>
 These options specify the backup style.  The default
backup style is +D.  The backup styles are:

<dl>
<dt>+DB, -DB</dt><dd>Write backup files into the same directory as the
destination file but change extension to ".bak".

<dt>+D</dt><dd>When on, backup files are placed in a single
directory.  The default backup directory is
"\vslick\backup\" (UNIX:
"$HOME/.vslick/backup") . You may define an
alternate backup directory by defining an
environment variable called VSLICKBACKUP.
The VSLICKBACKUP environment variable may
contain a drive specifier. The backup file gets the
same name part as the destination file.  For
example, given the destination file
"c:\project\test.c" (UNIX: "/project/test.c") , the
backup  file will be "c:\vslick\backup\test.c"
(UNIX: "$HOME/.vslick/backup/test.c").<br><br>

<b>Non-UNIX platforms</b>: For a network, you
may need to create the backup directory with
appropriate access rights manually before saving a
file.</dd>

<dt>-D</dt><dd>When on, backup file directories are derived from
concatenating a backup directory with the path and
name of the destination file.  The default backup
directory is "\vslick\backup\" (UNIX:
"$HOME/.vslick").  You may define an alternate
backup directory by defining an environment
variable called VSLICKBACKUP.  The
VSLICKBACKUP environment variable may
contain a drive specifier.  For example, given the
destination file "c:\project\test.c", the backup file
will be "c:\vslick\backup\project\test.c" (UNIX:
"$HOME/.vslick/backup/project/test.c").<br><br>

<b>Non-UNIX platforms</b>: For a network, you may
need to create the backup directory with appropriate
access rights manually before saving a file.</dd>

<dt>+DK,-DK</dt><dd>When on, backup files are placed in a directory off
the same directory as the destination file.  For
example, given the destination file
"c:\project\test.c" (UNIX: "$HOME/.vslick"), the
backup file will be "c:\project\backup\test.c"
(UNIX: "/project/backup/test.c").  This option
works well on networks.</dd>
</dl>
</dl>
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Returns:</B> <B><code>int</code></b><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">Returns 0 if successful.  Common return codes are:
INVALID_OPTION_RC, ACCESS_DENIED_RC,
ERROR_OPENING_FILE_RC, INSUFFICIENT_DISK_SPACE_RC,
ERROR_READING_FILE_RC, ERROR_WRITING_FILE_RC,
DRIVE_NOT_READY_RC, and PATH_NOT_FOUND_RC. On
error, message displayed.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Example:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">
<pre>
     // Expand tabs and write buffer to temporary file.
     vsCommandSave (0,"tempfile","+E");
</pre>
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Applies To:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">Edit Window, Editor Control
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Categories:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="Buffer_Functions.html">Buffer Functions</a>, <a href="Edit_Window_Methods.html">Edit Window Methods</a>, <a href="Editor_Control_Methods.html">Editor Control Methods</a>, <a href="File_Functions.html">File Functions</a></blockquote>
</body>
</html>
